:css
  .img_size{
    max-width: 300px;
    max-height: 300px;
  }
  .fl {
    float:left;
  }
- if flash[:notice]

  %b= flash[:notice]
%br
%br
- @posts.each do |p|
  %div{:id => "#{p.id}"}
    %div.panel.panel-success
      %div.panel-heading
        %b=link_to("#{p.title.truncate(30).capitalize}","/posts/#{p.id}")
      %div.panel-body.fl
        %img.img_size{:src=>p.avatar}
      %div.panel-body
        %b=p.description
      %div.panel-body.own_time_format 
        %b Posted 
        #{time_ago_in_words(p.created_at)} ago
      %div.panel-body 
        %b Posted by :
        #{p.user.email}
      -if current_user.id == p.user_id.to_i 
        %div.panel-body
          %b=link_to("Delete this post","javascript:void(0)","data-id" => "#{p.id}",:class => "delete_post")
      %div.panel-body 
        %b No of comments: 
        #{p.comments.where("is_archive =? ",false).count}
      %div.panel-body 
        %b No of likes: 
        #{p.likes.where("is_liked =? ",true).count}


      - if p.likes.where("is_liked =? and user_id =?",true,current_user.id).present?

        %div.panel-body
          %img{:src => "/assets/unlike",:height =>"30px",:width => "30px",:id => "like_post",:class => "like_post_icon"+"#{p.id}",:onclick => "like_post(#{p.id})"}
      -else

        %div.panel-body
          %img{:src => "/assets/like",:height =>"30px",:width => "30px",:id => "like_post",:class => "unlike_post_icon"+"#{p.id}",:onclick => "like_post(#{p.id})"}
    


      
=link_to("Create a new post",posts_new_path,:class=>"btn btn-success")

:javascript

  $(".delete_post").click(function() 
    {
      if(confirm("Are you sure..???"))
      {
        var id = $(this).data('id');
        $.ajax({
          type: 'DELETE',
          url: "/posts/delete_post/"+id,
          data:{'post_id': id},
          success: function(data)
          { 

          }, 
          error: function(data){ alert('error'); } 
        })
      }
    });


    function like_post(id) 
    {
      var post_id = id;
      var x = $( "img" ).hasClass( "like_post_icon"+id );
      $.ajax({
        type: 'PATCH',
        url: "/posts/like_post/"+id,
        data:{'like_boolean': x},
        success: function(data)
        { 
          
        }, 
        error: function(data){ alert('error'); } 
      })  
     
    }
